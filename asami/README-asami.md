# utmsks-slack-bot/asami

## どんな bot ？

関東の路線の運行情報をお知らせします。
- 路線を尋ねれば、現在の運行状況をつぶやきます。
- 路線を登録しておけば、ダイヤが通常でない状態から復旧まで、自動でお知らせします。

## 使い方

計算数学の Slack では、 @asami_kazari で mention できます。以下その前提で書きます。

### 一覧

**一覧** を含む mention には、監視対象の路線の運行状況を返します。

> kazunetakahashi [23:29]

> @asami_kazari: 一覧

> asami_kazari BOT [23:29] 

> 現在の運行状況は、私なら掌握可能です。

> 【山手線】現在､事故･遅延に関する情報はありません。(23時28分現在)

> 【京王井の頭線】現在､事故･遅延に関する情報はありません。(23時28分現在)

### 追加・削除

キーワードを「」で囲んで **追加** を含む mention を与えると、キーワードを含む路線を監視対象に追加します。同じく、キーワードを「」で囲んで **削除** を含む mention を与えると、キーワードを含む路線を監視対象から削除します。

> kazunetakahashi [23:39] 

> @asami_kazari: 「京王線」追加

> asami_kazari BOT [23:39] 

> 【京王線】を監視対象に追加しました。運行情報は完璧に頭に入れましたから。

> 【京王線】現在､事故･遅延に関する情報はありません。(23時39分現在)

> kazunetakahashi [23:39] 

> @asami_kazari: 「京王線」削除

> asami_kazari BOT [23:39] 

> 【京王線】を監視対象から削除しました。関東の運行状況は、私が仕切る！

キーワードを含む路線が複数存在する場合は、それらを列挙しますので、1つに絞ってまたやってください。

監視対象に追加された路線は、5分ごとに運行状況を確認します。ダイヤに乱れが生じた場合は #random チャンネルにお知らせをし、状況コメントがアップデートされるたびにコメントをつぶやき、ダイヤが通常になるまでお知らせを続けます。

路線の追加・削除は、みんなで適当にやってください。

### 一時参照

キーワードを「」で囲んで、一覧・追加・削除のいずれも含まない mention を与えると、キーワードを含む路線の運行状況を返します。

> kazunetakahashi [23:41] 

> @asami_kazari: 「動物園線」

> asami_kazari BOT [23:41] 

> 【京王動物園線】現在､事故･遅延に関する情報はありません。(23時41分現在)

一時的に運行状況を参照したい場合は、こちらをご利用ください。

## 参考

情報元は[Yahoo! 路線情報](http://transit.yahoo.co.jp/)です。

Nokogiri の使い方は http://blog.takuros.net/entry/2014/04/15/070434 を参考にしました。

モデル：http://dic.nicovideo.jp/a/%E8%8A%B1%E5%92%B2%E9%87%8C%E3%81%82%E3%81%95%E3%81%BF (題材的には http://dic.nicovideo.jp/a/%E6%98%9F%E5%AE%AE%E3%81%AF%E3%82%8B%E3%81%8B にするべきだったかもしれない)。当然ですが、この bot はこの版権元とは何ら関係ありません。
